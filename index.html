<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>jingfeng hello</title>
    <!-- 引入鼠标特效和点击爱心的外部脚本 -->
    <script src="https://cdn.jsdelivr.net/gh/zyoushuo/Blog/hexo/js/mouse_slide.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/zyoushuo/Blog/hexo/js/clicklove.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
            background-color: #f0f0f0;
        }
        button {
            padding: 15px 25px;
            margin: 15px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 8px;
            border: none;
            background-color: #ff6666;
            color: white;
        }
        /* 漂浮爱心样式 */
        .heart {
            position: fixed;
            font-size: 50px;
            color: red;
            animation: floatUp 3s linear forwards;
            pointer-events: none;
            z-index: 9999;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100vh) scale(1.5); opacity: 0; }
        }
        /* 哭泣表情样式 */
        #cryImg {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            z-index: 1000;
            display: none;
        }
        /* 粒子爱心画布样式 */
        #pinkboard {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 9998;
            display: none;
            background: rgba(0,0,0,0.8);
        }
        /* 粒子爱心文字样式 */
        .namebox {
            color: #fff;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            display: none;
        }
        .namebox h1 {
            margin: 0 auto;
            font-size: 3em;
        }
    </style>
</head>
<body>
    <h1>jingfeng hello</h1>

    <button id="examBtn">考试运气值</button>
    <button id="lzwBtn">今天有没有想lzw</button>

    <div id="choiceContainer"></div>
    <img id="cryImg" src="https://i.imgur.com/6KXJbQJ.png" alt="哭泣">

    <!-- 粒子爱心画布和文字 -->
    <canvas id="pinkboard"></canvas>
    <div class="namebox">
        <h1>GJF&#10084;&#65039;LZW</h1>
    </div>

    <script>
        window.onload = function() {
            const examBtn = document.getElementById("examBtn");
            const lzwBtn = document.getElementById("lzwBtn");
            const choiceContainer = document.getElementById("choiceContainer");
            const cryImg = document.getElementById("cryImg");
            const pinkboard = document.getElementById("pinkboard");
            const namebox = document.querySelector(".namebox");

            // 考试按钮逻辑
            examBtn.addEventListener("click", function(){
                alert("恭喜你通过了明天的考试！");
            });

            // 想lzw按钮逻辑
            lzwBtn.addEventListener("click", function(){
                choiceContainer.innerHTML = "";
                // 有按钮 - 触发粒子爱心+鼠标星星特效
                const yesBtn = document.createElement("button");
                yesBtn.textContent = "有";
                yesBtn.addEventListener("click", function(){
                    choiceContainer.innerHTML = "";
                    // 显示粒子画布和文字
                    pinkboard.style.display = "block";
                    namebox.style.display = "block";
                    // 执行粒子爱心动画
                    initParticleHeart();
                });

                // 没有按钮 - 显示哭泣表情
                const noBtn = document.createElement("button");
                noBtn.textContent = "没有";
                noBtn.addEventListener("click", function(){
                    cryImg.style.display = "block";
                    setTimeout(()=>{ cryImg.style.display="none"; }, 5000);
                    choiceContainer.innerHTML = "";
                });

                choiceContainer.appendChild(yesBtn);
                choiceContainer.appendChild(noBtn);
            });

            // 原漂浮爱心生成函数
            function createHeart() {
                const heart = document.createElement("div");
                heart.className = "heart";
                heart.style.left = Math.random()*window.innerWidth + "px";
                heart.innerHTML = "❤️";
                document.body.appendChild(heart);
                const duration = 2 + Math.random()*3;
                heart.style.animationDuration = duration + "s";
                setTimeout(()=>{ heart.remove(); }, duration*1000);
            }
            function createMultipleHearts(count){
                for(let i=0;i<count;i++){
                    createHeart();
                }
            }

            // 粒子爱心动画核心函数
            function initParticleHeart() {
                var settings = {
                    particles: {
                        length: 500,
                        duration: 2,
                        velocity: 100,
                        effect: -0.75,
                        size: 30,
                    },
                };

                (function(){
                    var b=0;
                    var c=["ms","moz","webkit","o"];
                    for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){
                        window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];
                        window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"];
                    }
                    if(!window.requestAnimationFrame){
                        window.requestAnimationFrame=function(h,e){
                            var d=new Date().getTime();
                            var f=Math.max(0,16-(d-b));
                            var g=window.setTimeout(function(){h(d+f)},f);
                            b=d+f;
                            return g;
                        };
                    }
                    if(!window.cancelAnimationFrame){
                        window.cancelAnimationFrame=function(d){clearTimeout(d);};
                    }
                })();

                var Point = (function() {
                    function Point(x, y) {
                        this.x = (typeof x !== 'undefined') ? x : 0;
                        this.y = (typeof y !== 'undefined') ? y : 0;
                    }
                    Point.prototype.clone = function() {
                        return new Point(this.x, this.y);
                    };
                    Point.prototype.length = function(length) {
                        if (typeof length == 'undefined')
                            return Math.sqrt(this.x * this.x + this.y * this.y);
                        this.normalize();
                        this.x *= length;
                        this.y *= length;
                        return this;
                    };
                    Point.prototype.normalize = function() {
                        var length = this.length();
                        this.x /= length;
                        this.y /= length;
                        return this;
                    };
                    return Point;
                })();

                var Particle = (function() {
                    function Particle() {
                        this.position = new Point();
                        this.velocity = new Point();
                        this.acceleration = new Point();
                        this.age = 0;
                    }
                    Particle.prototype.initialize = function(x, y, dx, dy) {
                        this.position.x = x;
                        this.position.y = y;
                        this.velocity.x = dx;
                        this.velocity.y = dy;
                        this.acceleration.x = dx * settings.particles.effect;
                        this.acceleration.y = dy * settings.particles.effect;
                        this.age = 0;
                    };
                    Particle.prototype.update = function(deltaTime) {
                        this.position.x += this.velocity.x * deltaTime;
                        this.position.y += this.velocity.y * deltaTime;
                        this.velocity.x += this.acceleration.x * deltaTime;
                        this.velocity.y += this.acceleration.y * deltaTime;
                        this.age += deltaTime;
                    };
                    Particle.prototype.draw = function(context, image) {
                        function ease(t) {
                            return (--t) * t * t + 1;
                        }
                        var size = image.width * ease(this.age / settings.particles.duration);
                        context.globalAlpha = 1 - this.age / settings.particles.duration;
                        context.drawImage(image, this.position.x - size / 2, this.position.y - size / 2, size, size);
                    };
                    return Particle;
                })();

                var ParticlePool = (function() {
                    var particles, firstActive = 0, firstFree = 0, duration = settings.particles.duration;
                    function ParticlePool(length) {
                        particles = new Array(length);
                        for (var i = 0; i < particles.length; i++)
                            particles[i] = new Particle();
                    }
                    ParticlePool.prototype.add = function(x, y, dx, dy) {
                        particles[firstFree].initialize(x, y, dx, dy);
                        firstFree++;
                        if (firstFree == particles.length) firstFree = 0;
                        if (firstActive == firstFree ) firstActive++;
                        if (firstActive == particles.length) firstActive = 0;
                    };
                    ParticlePool.prototype.update = function(deltaTime) {
                        var i;
                        if (firstActive < firstFree) {
                            for (i = firstActive; i < firstFree; i++)
                                particles[i].update(deltaTime);
                        }
                        if (firstFree < firstActive) {
                            for (i = firstActive; i < particles.length; i++)
                                particles[i].update(deltaTime);
                            for (i = 0; i < firstFree; i++)
                                particles[i].update(deltaTime);
                        }
                        while (particles[firstActive].age >= duration && firstActive != firstFree) {
                            firstActive++;
                            if (firstActive == particles.length) firstActive = 0;
                        }
                    };
                    ParticlePool.prototype.draw = function(context, image) {
                        if (firstActive < firstFree) {
                            for (i = firstActive; i < firstFree; i++)
                                particles[i].draw(context, image);
                        }
                        if (firstFree < firstActive) {
                            for (i = firstActive; i < particles.length; i++)
                                particles[i].draw(context, image);
                            for (i = 0; i < firstFree; i++)
                                particles[i].draw(context, image);
                        }
                    };
                    return ParticlePool;
                })();

                (function(canvas) {
                    var context = canvas.getContext('2d'),
                            particles = new ParticlePool(settings.particles.length),
                            particleRate = settings.particles.length / settings.particles.duration,
                            time;

                    function pointOnHeart(t) {
                        return new Point(
                                160 * Math.pow(Math.sin(t), 3),
                                130 * Math.cos(t) - 50 * Math.cos(2 * t) - 20 * Math.cos(3 * t) - 10 * Math.cos(4 * t) + 25
                        );
                    }

                    var image = (function() {
                        var canvas = document.createElement("canvas"),
                                context = canvas.getContext('2d');
                        canvas.width = settings.particles.size;
                        canvas.height = settings.particles.size;
                        function to(t) {
                            var point = pointOnHeart(t);
                            point.x = settings.particles.size / 2 + point.x * settings.particles.size / 350;
                            point.y = settings.particles.size / 2 - point.y * settings.particles.size / 350;
                            return point;
                        }
                        context.beginPath();
                        var t = -Math.PI;
                        var point = to(t);
                        context.moveTo(point.x, point.y);
                        while (t < Math.PI) {
                            t += 0.01;
                            point = to(t);
                            context.lineTo(point.x, point.y);
                        }
                        context.closePath();
                        context.fillStyle = '#ff30c5';
                        context.fill();
                        var image = new Image();
                        image.src = canvas.toDataURL();
                        return image;
                    })();

                    function render() {
                        requestAnimationFrame(render);
                        var newTime = new Date().getTime() / 1000,
                                deltaTime = newTime - (time || newTime);
                        time = newTime;
                        context.clearRect(0, 0, canvas.width, canvas.height);
                        var amount = particleRate * deltaTime;
                        for (var i = 0; i < amount; i++) {
                            var pos = pointOnHeart(Math.PI - 2 * Math.PI * Math.random());
                            var dir = pos.clone().length(settings.particles.velocity);
                            particles.add(canvas.width / 2 + pos.x, canvas.height / 2 - pos.y, dir.x, -dir.y);
                        }
                        particles.update(deltaTime);
                        particles.draw(context, image);
                    }

                    function onResize() {
                        canvas.width = canvas.clientWidth;
                        canvas.height = canvas.clientHeight;
                    }
                    window.onresize = onResize;
                    setTimeout(function() {
                        onResize();
                        render();
                    }, 10);
                })(pinkboard);
            }
        }
    </script>
</body>
</html>
